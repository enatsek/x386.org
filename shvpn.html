<!-- HTML Header Start -->
<!DOCTYPE html>
<html><head>
<title>x386.org: Debian and Ubuntu Documentation</title>
<meta charset="UTF-8">
 
 
 
 
 
 
<style>
/* base.css */
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 40px;
  border: 1px solid transparent;
}

body blockquote {
  background-color: initial;
}

body code {
  color: inherit;
}

body code > div {
  background: none;
}

body.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

body p,
body blockquote,
body ul,
body ol,
body dl,
body table,
body pre {
  margin-top: 16px;
  margin-bottom: 16px;
}

/* github-markdown.css */
body {
  color-scheme: dark;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  margin: 0;
  color: #c9d1d9;
  background-color: #0d1117;
  font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji";
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word
}
body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom
}
body h1:hover .anchor .octicon-link:before,
body h2:hover .anchor .octicon-link:before,
body h3:hover .anchor .octicon-link:before,
body h4:hover .anchor .octicon-link:before,
body h5:hover .anchor .octicon-link:before,
body h6:hover .anchor .octicon-link:before {
  width: 16px;
  height: 16px;
  content: ' ';
  display: inline-block;
  background-color: currentColor;
  -webkit-mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>");
  mask-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' aria-hidden='true'><path fill-rule='evenodd' d='M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z'></path></svg>")
}
body details,
body figcaption,
body figure {
  display: block
}
body summary {
  display: list-item
}
body a {
  background-color: transparent;
  color: #58a6ff;
  text-decoration: none
}
body a:active,
body a:hover {
  outline-width: 0
}
body abbr[title] {
  border-bottom: none;
  -webkit-text-decoration: underline dotted;
  text-decoration: underline dotted
}
body b,
body strong {
  font-weight: 600
}
body dfn {
  font-style: italic
}
body h1 {
  margin: .67em 0;
  font-weight: 600;
  padding-bottom: .3em;
  font-size: 1.8em;
  border-bottom: 1px solid #21262d
}
body mark {
  background-color: #ff0;
  color: #c9d1d9
}
body small {
  font-size: 90%
}
body sub,
body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline
}
body sub {
  bottom: -.25em
}
body sup {
  top: -.5em
}
body img {
  border-style: none;
  max-width: 100%;
  box-sizing: content-box;
  background-color: #0d1117
}
body code,
body kbd,
body pre,
body samp {
  font-family: monospace,monospace;
  font-size: 1em
}
body figure {
  margin: 1em 40px
}
body hr {
  box-sizing: content-box;
  overflow: hidden;
  background: 0 0;
  border-bottom: 1px solid #21262d;
  height: .25em;
  padding: 0;
  margin: 24px 0;
  background-color: #30363d;
  border: 0
}
body [type=reset],
body [type=submit],
body html [type=button] {
  -webkit-appearance: button
}
body [type=button]::-moz-focus-inner,
body [type=reset]::-moz-focus-inner,
body [type=submit]::-moz-focus-inner {
  border-style: none;
  padding: 0
}
body [type=button]:-moz-focusring,
body [type=reset]:-moz-focusring,
body [type=submit]:-moz-focusring {
  outline: 1px dotted ButtonText
}
body [type=checkbox],
body [type=radio] {
  box-sizing: border-box;
  padding: 0
}
body [type=number]::-webkit-inner-spin-button,
body [type=number]::-webkit-outer-spin-button {
  height: auto
}
body [type=search] {
  -webkit-appearance: textfield;
  outline-offset: -2px
}
body [type=search]::-webkit-search-cancel-button,
body [type=search]::-webkit-search-decoration {
  -webkit-appearance: none
}
body ::-webkit-input-placeholder {
  color: inherit;
  opacity: .54
}
body ::-webkit-file-upload-button {
  -webkit-appearance: button;
  font: inherit
}
body a:hover {
  text-decoration: underline
}
body hr::before {
  display: table;
  content: ""
}
body hr::after {
  display: table;
  clear: both;
  content: ""
}
body table {
  border-spacing: 0;
  border-collapse: collapse;
  display: block;
  width: max-content;
  max-width: 100%;
  overflow: auto
}
body td,
body th {
  padding: 0
}
body details summary {
  cursor: pointer
}
body details:not([open]) > :not(summary) {
  display: none!important
}
body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;
  line-height: 10px;
  color: #c9d1d9;
  vertical-align: middle;
  background-color: #161b22;
  border: solid 1px rgba(110,118,129,.4);
  border-bottom-color: rgba(110,118,129,.4);
  border-radius: 6px;
  box-shadow: inset 0 -1px 0 rgba(110,118,129,.4)
}

details > summary {
  font-weight: 600;
  font-size: 1.4em;
  padding-top: .1em;
}


body h1,
body h2,
body h3,
body h4,
body h5,
body h6 {
  margin-top: 24px;
  margin-bottom: 16px;
  font-weight: 600;
  line-height: 1.25
}
body h2 {
  font-weight: 600;
  font-size: 1.6em;
  border-top: 1px solid #21262d;
  padding-top: .2em;
}
body h3 {
  font-weight: 600;
  font-size: 1.4em;
  border-top: 1px solid #21262d;
  padding-top: .2em;
}
body h4 {
  font-weight: 600;
  font-size: 1.2em;
  border-top: 1px solid #21262d;
  padding-top: .2em;
}
body h5 {
  font-weight: 600;
  font-size: 1.0em;
  border-top: 1px solid #21262d;
  padding-top: .2em;
}
body h6 {
  font-weight: 600;
  font-size: 1em;
  color: #8b949e
}
body p {
  margin-top: 0;
  margin-bottom: 10px
}
body blockquote {
  margin: 0;
  padding: 0 1em;
  color: #8b949e;
  border-left: .25em solid #30363d
}
body ol,
body ul {
  margin-top: 0;
  margin-bottom: 0;
  padding-left: 2em
}
body ol ol,
body ul ol {
  list-style-type: lower-roman
}
body ol ol ol,
body ol ul ol,
body ul ol ol,
body ul ul ol {
  list-style-type: lower-alpha
}
body dd {
  margin-left: 0
}
body code,
body tt {
  font-family: ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;
  font-size: 12px
}
body pre {
  margin-top: 0;
  margin-bottom: 0;
  font-family: ui-monospace,SFMono-Regular,SF Mono,Menlo,Consolas,Liberation Mono,monospace;
  font-size: 12px;
  word-wrap: normal
}
body :-ms-input-placeholder {
  color: #484f58;
  opacity: 1
}
body ::-ms-input-placeholder {
  color: #484f58;
  opacity: 1
}
body ::placeholder {
  color: #484f58;
  opacity: 1
}
body .pl-c {
  color: #8b949e
}
body .pl-c1,
body .pl-s .pl-v {
  color: #79c0ff
}
body .pl-e,
body .pl-en {
  color: #d2a8ff
}
body .pl-s .pl-s1,
body .pl-smi {
  color: #c9d1d9
}
body .pl-ent {
  color: #7ee787
}
body .pl-k {
  color: #ff7b72
}
body .pl-pds,
body .pl-s,
body .pl-s .pl-pse .pl-s1,
body .pl-sr,
body .pl-sr .pl-cce,
body .pl-sr .pl-sra,
body .pl-sr .pl-sre {
  color: #a5d6ff
}
body .pl-smw,
body .pl-v {
  color: #ffa657
}
body .pl-bu {
  color: #f85149
}
body .pl-ii {
  color: #f0f6fc;
  background-color: #8e1519
}
body .pl-c2 {
  color: #f0f6fc;
  background-color: #b62324
}
body .pl-sr .pl-cce {
  font-weight: 700;
  color: #7ee787
}
body .pl-ml {
  color: #f2cc60
}
body .pl-mh,
body .pl-mh .pl-en,
body .pl-ms {
  font-weight: 700;
  color: #1f6feb
}
body .pl-mi {
  font-style: italic;
  color: #c9d1d9
}
body .pl-mb {
  font-weight: 700;
  color: #c9d1d9
}
body .pl-md {
  color: #ffdcd7;
  background-color: #67060c
}
body .pl-mi1 {
  color: #aff5b4;
  background-color: #033a16
}
body .pl-mc {
  color: #ffdfb6;
  background-color: #5a1e02
}
body .pl-mi2 {
  color: #c9d1d9;
  background-color: #1158c7
}
body .pl-mdr {
  font-weight: 700;
  color: #d2a8ff
}
body .pl-ba {
  color: #8b949e
}
body .pl-sg {
  color: #484f58
}
body .pl-corl {
  text-decoration: underline;
  color: #a5d6ff
}
body [data-catalyst] {
  display: block
}
body g-emoji {
  font-family: "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
  font-size: 1em;
  font-style: normal!important;
  font-weight: 400;
  line-height: 1;
  vertical-align: -.075em
}
body g-emoji img {
  width: 1em;
  height: 1em
}
body::before {
  display: table;
  content: ""
}
body::after {
  display: table;
  clear: both;
  content: ""
}
body > :first-child {
  margin-top: 0!important
}
body > :last-child {
  margin-bottom: 0!important
}
body a:not([href]) {
  color: inherit;
  text-decoration: none
}
body .absent {
  color: #f85149
}
body .anchor {
  float: left;
  padding-right: 4px;
  margin-left: -20px;
  line-height: 1
}
body .anchor:focus {
  outline: 0
}
body blockquote,
body details,
body dl,
body ol,
body p,
body pre,
body table,
body ul {
  margin-top: 0;
  margin-bottom: 16px
}
body blockquote > :first-child {
  margin-top: 0
}
body blockquote > :last-child {
  margin-bottom: 0
}
body sup > a::before {
  content: "["
}
body sup > a::after {
  content: "]"
}
body h1 .octicon-link,
body h2 .octicon-link,
body h3 .octicon-link,
body h4 .octicon-link,
body h5 .octicon-link,
body h6 .octicon-link {
  color: #c9d1d9;
  vertical-align: middle;
  visibility: hidden
}
body h1:hover .anchor,
body h2:hover .anchor,
body h3:hover .anchor,
body h4:hover .anchor,
body h5:hover .anchor,
body h6:hover .anchor {
  text-decoration: none
}
body h1:hover .anchor .octicon-link,
body h2:hover .anchor .octicon-link,
body h3:hover .anchor .octicon-link,
body h4:hover .anchor .octicon-link,
body h5:hover .anchor .octicon-link,
body h6:hover .anchor .octicon-link {
  visibility: visible
}
body h1 code,
body h1 tt,
body h2 code,
body h2 tt,
body h3 code,
body h3 tt,
body h4 code,
body h4 tt,
body h5 code,
body h5 tt,
body h6 code,
body h6 tt {
  padding: 0 .2em;
  font-size: inherit
}
body ol.no-list,
body ul.no-list {
  padding: 0;
  list-style-type: none
}
body ol[type="1"] {
  list-style-type: decimal
}
body ol[type=a] {
  list-style-type: lower-alpha
}
body ol[type=i] {
  list-style-type: lower-roman
}
body div > ol:not([type]) {
  list-style-type: decimal
}
body ol ol,
body ol ul,
body ul ol,
body ul ul {
  margin-top: 0;
  margin-bottom: 0
}
body li > p {
  margin-top: 16px
}
body li + li {
  margin-top: .25em
}
body dl {
  padding: 0
}
body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: 600
}
body dl dd {
  padding: 0 16px;
  margin-bottom: 16px
}
body table th {
  font-weight: 600
}
body table td,
body table th {
  padding: 6px 13px;
  border: 1px solid #30363d
}
body table tr {
  background-color: #0d1117;
  border-top: 1px solid #21262d
}
body table tr:nth-child(2n) {
  background-color: #161b22
}
body table img {
  background-color: transparent
}
body img[align=right] {
  padding-left: 20px
}
body img[align=left] {
  padding-right: 20px
}
body .emoji {
  max-width: none;
  vertical-align: text-top;
  background-color: transparent
}
body span.frame {
  display: block;
  overflow: hidden
}
body span.frame > span {
  display: block;
  float: left;
  width: auto;
  padding: 7px;
  margin: 13px 0 0;
  overflow: hidden;
  border: 1px solid #30363d
}
body span.frame span img {
  display: block;
  float: left
}
body span.frame span span {
  display: block;
  padding: 5px 0 0;
  clear: both;
  color: #c9d1d9
}
body span.align-center {
  display: block;
  overflow: hidden;
  clear: both
}
body span.align-center > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: center
}
body span.align-center span img {
  margin: 0 auto;
  text-align: center
}
body span.align-right {
  display: block;
  overflow: hidden;
  clear: both
}
body span.align-right > span {
  display: block;
  margin: 13px 0 0;
  overflow: hidden;
  text-align: right
}
body span.align-right span img {
  margin: 0;
  text-align: right
}
body span.float-left {
  display: block;
  float: left;
  margin-right: 13px;
  overflow: hidden
}
body span.float-left span {
  margin: 13px 0 0
}
body span.float-right {
  display: block;
  float: right;
  margin-left: 13px;
  overflow: hidden
}
body span.float-right > span {
  display: block;
  margin: 13px auto 0;
  overflow: hidden;
  text-align: right
}
body code,
body tt {
  padding: .2em .4em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(110,118,129,.4);
  border-radius: 6px
}
body code br,
body tt br {
  display: none
}
body del code {
  text-decoration: inherit
}
body pre code {
  font-size: 100%
}
body pre > code {
  padding: 0;
  margin: 0;
  word-break: normal;
  white-space: pre;
  background: 0 0;
  border: 0
}
body .highlight {
  margin-bottom: 16px
}
body .highlight pre {
  margin-bottom: 0;
  word-break: normal
}
body .highlight pre,
body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #161b22;
  border-radius: 6px
}
body pre code,
body pre tt {
  display: inline;
  max-width: auto;
  padding: 0;
  margin: 0;
  overflow: visible;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0
}
body .csv-data td,
body .csv-data th {
  padding: 5px;
  overflow: hidden;
  font-size: 12px;
  line-height: 1;
  text-align: left;
  white-space: nowrap
}
body .csv-data .blob-num {
  padding: 10px 8px 9px;
  text-align: right;
  background: #0d1117;
  border: 0
}
body .csv-data tr {
  border-top: 0
}
body .csv-data th {
  font-weight: 600;
  background: #161b22;
  border-top: 0
}
body .footnotes {
  font-size: 12px;
  color: #8b949e;
  border-top: 1px solid #30363d
}
body .footnotes ol {
  padding-left: 16px
}
body .footnotes li {
  position: relative
}
body .footnotes li:target::before {
  position: absolute;
  top: -8px;
  right: -8px;
  bottom: -8px;
  left: -24px;
  pointer-events: none;
  content: "";
  border: 2px solid #1f6feb;
  border-radius: 6px
}
body .footnotes li:target {
  color: #c9d1d9
}
body .footnotes .data-footnote-backref g-emoji {
  font-family: monospace
}
body [hidden] {
  display: none!important
}
body ::-webkit-calendar-picker-indicator {
  filter: invert(50%)
}

/* node_modules/highlight.js/styles/github-dark.css */
pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}/*!
  Theme: GitHub Dark
  Description: Dark theme as seen on github.com
  Author: github.com
  Maintainer: @Hirse
  Updated: 2021-05-15

  Outdated base version: https://github.com/primer/github-syntax-dark
  Current colors taken from GitHub's CSS
*/.hljs{color:#c9d1d9;background:#0d1117}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#ff7b72}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#d2a8ff}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#79c0ff}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#a5d6ff}.hljs-built_in,.hljs-symbol{color:#ffa657}.hljs-code,.hljs-comment,.hljs-formula{color:#8b949e}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#7ee787}.hljs-subst{color:#c9d1d9}.hljs-section{color:#1f6feb;font-weight:700}.hljs-bullet{color:#f2cc60}.hljs-emphasis{color:#c9d1d9;font-style:italic}.hljs-strong{color:#c9d1d9;font-weight:700}.hljs-addition{color:#aff5b4;background-color:#033a16}.hljs-deletion{color:#ffdcd7;background-color:#67060c}

</style>
</head>
<body>
<div class="document">
<div class="header"></div><div class="inner">
<!-- HTML Header End -->
<!-- Header Start -->

<h1>x386.org: Debian and Ubuntu Documentation</h1>
<h4>| &ensp;<a href="index.html">Home</a>&ensp; |&ensp; <a href="about.html">About</a> &ensp;| &ensp;<a href="contact.html">Contact</a>&ensp; | &ensp;<a href="license.html">License</a>&ensp; | &ensp;<a href="privacy_policy.html">Privacy Policy</a>&ensp; |</h4>
<!-- Copyright Start -->
<details>
<summary>Copyright (C) 2020 - 2025 Exforge exforge@x386.org</summary>
<hr />
<p>This document is free text: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or any later version.</p>
<p>This document is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program.  If not, see: <a href="https://www.gnu.org/licenses/">www.gnu.org/licenses/</a>.</p>
<hr />
</details>
<!-- Copyright End -->

<!-- Header End -->
<h5>Self Hosted VPN Server</h5>
<h1>VPN Server Configuration Tutorial using Wireguard for Debian and Ubuntu</h1>
<details>
<summary>
0. Specs
</summary>
<hr />
<h3>0.0. The What</h3>
<p>A VPN server for personal computers acts as a secure, private gateway between your device and the internet. When you connect to it using VPN software, it creates an encrypted tunnel that protects all your online activity. This process hides your real IP address, making it appear as if you are browsing from the server's location, which helps with privacy and accessing region-locked content. </p>
<p>Essentially, it provides a safe and private connection for a single user, even when using public Wi-Fi networks.</p>
<h3>0.1. Environment</h3>
<ul>
<li>Server: <ul>
<li>IP: 192.227.167.142</li>
<li>OS: Debian 13 Server or Ubuntu 24.04 LTS Server</li>
<li>nic: eth0</li>
</ul>
</li>
<li>Client1: Debian 13 / Ubuntu 24.04 Desktop &amp; Server, Linux Mint</li>
<li>Client2: Windows 11</li>
<li>Client3: Android</li>
</ul>
<h3>0.2. WireGuard Concepts</h3>
<ul>
<li>
<p>WireGuard does not use a strict client-server model. In practice, all WireGuard nodes can act as servers and connect to each other in a peer-to-peer fashion.</p>
</li>
<li>
<p>In our configuration, the central WireGuard server will connect to many clients, and each client will only connect to this central server.</p>
</li>
<li>
<p>Connections can be initiated from either side. However, in our specific scenario, connections will always be initiated from the clients.</p>
</li>
<li>
<p>Every host in a WireGuard network must have a public key and a private key. This key pair allows peers to identify and authorize each other.</p>
</li>
</ul>
<h3>0.3. Configuration Templates</h3>
<p>Our central WireGuard server will use the following configuration template. You will need to replace the placeholder values with your server's private key and the clients' public keys. These keys are generated after installing WireGuard. Also, ensure you specify the correct name of your server's network interface (e.g., eth0) in the "NAT for clients" section.</p>
<p>Server Configuration (/etc/wireguard/wg0.conf):</p>
<pre><code>[Interface]
Address = 10.100.0.100/24
ListenPort = 53
PrivateKey = serverprivkey

# NAT for clients
PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

[Peer]
# Client 1
PublicKey = client1pubkey
AllowedIPs = 10.100.0.1/32

[Peer]
# Client 2
PublicKey = client2pubkey
AllowedIPs = 10.100.0.2/32

[Peer]
# Client 3
PublicKey = client3pubkey
AllowedIPs = 10.100.0.3/32

[Peer]
# Client 4
PublicKey = client4pubkey
AllowedIPs = 10.100.0.4/32
</code></pre>
<p>Notes on the server configuration:</p>
<ul>
<li>
<p>The network 10.100.0.0/24 is arbitrarily chosen for the WireGuard tunnel. You can use any private IP range, though 10.x.x.x is often a good choice.</p>
</li>
<li>
<p>Port 53 is selected for WireGuard. It is the same port used for DNS, which may help obfuscate VPN traffic from ISPs that attempt to block it.</p>
</li>
<li>
<p>We need to assign a unique IP address (e.g., 10.100.0.1, 10.100.0.2, ...) and a public/private key pair for the server and every client.</p>
</li>
</ul>
<p>Our WireGuard clients will use the following configuration templates. Remember to replace the placeholders with the server's public key and each client's respective private key.</p>
<pre><code># Client1
[Interface]
PrivateKey = client1privkey
Address = 10.100.0.1/32
DNS = 1.1.1.1

[Peer]
PublicKey = serverpubkey
Endpoint = serverpublicip:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<pre><code># Client2
[Interface]
PrivateKey = client2privkey
Address = 10.100.0.2/32
DNS = 1.1.1.1

[Peer]
PublicKey = serverpubkey
Endpoint = serverpublicip:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<pre><code># Client3
[Interface]
PrivateKey = client3privkey
Address = 10.100.0.3/32
DNS = 1.1.1.1

[Peer]
PublicKey = serverpubkey
Endpoint = serverpublicip:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<p>Notes on the client configuration:</p>
<ul>
<li>
<p>Each client must have its own configuration file with a unique IP address and key pair.</p>
</li>
<li>
<p>Specifying a DNS address (like 1.1.1.1) is necessary because your ISP's DNS might not resolve certain domain names correctly when the tunnel is active.</p>
</li>
<li>
<p>The PersistentKeepalive option sends an empty packet every 25 seconds to maintain a connection state through NATs and firewalls.</p>
</li>
</ul>
<h3>0.4. Sources</h3>
<ul>
<li><a href="https://www.deepseek.com/">Deepseek</a>   </li>
<li><a href="https://chatgpt.com/">ChatGPT</a>   </li>
<li><a href="https://claude.ai/">Claude</a>  </li>
<li><a href="https://www.wireguard.com/">Wireguard Documentation</a></li>
</ul>
<p><br></p>
</details>
<details>
<summary>
1. Server Configuration
</summary>
<hr />
<p>Enable IP Forwarding</p>
<p>The VPN server needs to forward traffic between its physical network interface and the WireGuard tunnel.</p>
<pre><code>echo 'net.ipv4.ip_forward=1' | sudo tee -a /etc/sysctl.conf
sudo sysctl -p                    # Apply the change
sudo sysctl net.ipv4.ip_forward   # Verify it's set to 1
</code></pre>
<p>Free Port 53 (Ubuntu Systems)</p>
<p>On Ubuntu, port 53 is often used by the systemd-resolved service. We need to free it or choose a different port for WireGuard. To free port 53, edit the systemd-resolved configuration:</p>
<pre><code>sudo nano /etc/systemd/resolved.conf
</code></pre>
<p>Find the line (around line 19) that says:</p>
<pre><code>#DNSStubListener=yes
</code></pre>
<p>Change it to:</p>
<pre><code>DNSStubListener=no
</code></pre>
<p>Save the file and restart the service:</p>
<pre><code>sudo systemctl restart systemd-resolved
</code></pre>
<p>Install WireGuard and iptables</p>
<p>We need iptables to configure NAT, which allows clients to access the internet through the server.</p>
<pre><code>sudo apt update
sudo apt install -y wireguard iptables
</code></pre>
<p>Generate Key Pairs</p>
<p>Create a directory for the keys and generate the key pairs for the server and clients.</p>
<pre><code>mkdir wg &amp;&amp; cd wg
wg genkey | tee serverprivkey | wg pubkey &gt; serverpubkey
wg genkey | tee client1privkey | wg pubkey &gt; client1pubkey
wg genkey | tee client2privkey | wg pubkey &gt; client2pubkey
wg genkey | tee client3privkey | wg pubkey &gt; client3pubkey
</code></pre>
<p>For reference, the generated keys in this example are:</p>
<p>Server: </p>
<ul>
<li>Privkey: <code>kAy+LgQ3EkJtTKyB1N0BnbXGZVJE/pX6SH2yCG2l1lI=</code></li>
<li>Pubkey:  <code>OCtqLy2OkpuiBPhmXR0DbhbaVDhpuS4AVDm3yZDP1XU=</code></li>
</ul>
<p>Client1:</p>
<ul>
<li>Privkey: <code>SJPFU+D5Eoa3cSseIjWNh44dUQfyyFYxw0m4qGRSrFc=</code> </li>
<li>Pubkey:  <code>KgjPrrOPamV81q76C0Cql2fU1K7sSiigqYXVlwkKyBA=</code></li>
</ul>
<p>Client2:</p>
<ul>
<li>Privkey: <code>gCJE0PoqARqSnQgq1v87v7QcSzUn97d0abVM7BpqjFc=</code></li>
<li>Pubkey: <code>ZfZtUviU/jUAxEcIEXnf2d6rW0RcBFg+1Wt4kNnpTxg=</code></li>
</ul>
<p>Client3:</p>
<ul>
<li>Privkey: <code>gLoXU+1aNQmcK/OtjSUJGnOXt28w/mRo1szjU+XO/XM=</code></li>
<li>Pubkey:  <code>IG/wUYUGSDuZI0+DZsE6lq1OLNzx8aNIp8SUjllAwj8=</code></li>
</ul>
<p>Create and Activate the WireGuard Configuration</p>
<p>Create the WireGuard configuration file:</p>
<pre><code>sudo nano /etc/wireguard/wg0.conf
</code></pre>
<p>Populate the file with the configuration below. Remember to use your actual server private key and client public keys. Also, verify your network interface name (e.g., eth0). You can add as many client <code>[Peer]</code> sections as needed.</p>
<pre><code>[Interface]
Address = 10.100.0.100/24
ListenPort = 53
PrivateKey = kAy+LgQ3EkJtTKyB1N0BnbXGZVJE/pX6SH2yCG2l1lI=

# NAT for clients
PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

[Peer]
# Client 1
PublicKey = KgjPrrOPamV81q76C0Cql2fU1K7sSiigqYXVlwkKyBA=
AllowedIPs = 10.100.0.1/32

[Peer]
# Client 2
PublicKey = ZfZtUviU/jUAxEcIEXnf2d6rW0RcBFg+1Wt4kNnpTxg=
AllowedIPs = 10.100.0.2/32

[Peer]
# Client 3
PublicKey = IG/wUYUGSDuZI0+DZsE6lq1OLNzx8aNIp8SUjllAwj8=
AllowedIPs = 10.100.0.3/32
</code></pre>
<p>Enable, start, verify the service.</p>
<pre><code>sudo systemctl enable wg-quick@wg0
sudo systemctl start wg-quick@wg0
sudo wg show     # Verify the tunnel status and peers
</code></pre>
<p><br></p>
</details>
<details>
<summary>
2. Debian / Ubuntu &amp; Derivatives Client Configuration
</summary>
<hr />
<p>This configuration should work on all Debian-based and Ubuntu-based systems, including Mint and MX Linux. It has been tested on Debian 13, Ubuntu 24.04, and Linux Mint 22.2.</p>
<p>Install WireGuard and resolvconf. The resolvconf package is needed to manage DNS settings for the WireGuard interface.</p>
<pre><code>sudo apt update
sudo apt install -y wireguard resolvconf
</code></pre>
<p>Create the client configuration file:</p>
<pre><code>sudo nano /etc/wireguard/wg0.conf
</code></pre>
<p>Populate the file with the configuration below, using the correct private key for this client, the server's public key, and the server's public IP address.</p>
<pre><code>[Interface]
PrivateKey = SJPFU+D5Eoa3cSseIjWNh44dUQfyyFYxw0m4qGRSrFc=
Address = 10.100.0.1/32
DNS = 1.1.1.1

[Peer]
PublicKey = OCtqLy2OkpuiBPhmXR0DbhbaVDhpuS4AVDm3yZDP1XU=
Endpoint = 192.227.167.142:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<p>Start the WireGuard tunnel and verify its status:</p>
<pre><code>sudo wg-quick up wg0
sudo wg show     # Verify the tunnel
</code></pre>
<p>Ping the server's tunnel IP:</p>
<pre><code>ping 10.100.0.100
</code></pre>
<p>Check your public IP address (it should match your server's IP)</p>
<pre><code>curl https://ip.x386.org
</code></pre>
<p>If the displayed IP is your server's IP (in my case, 192.227.167.142), you are successfully routing your internet traffic through the WireGuard server.</p>
<p>To deactivate the VPN temporarily:</p>
<pre><code>sudo wg-quick down wg0
</code></pre>
<p>To activate the VPN automatically at startup:</p>
<pre><code>sudo systemctl enable wg-quick@wg0
</code></pre>
<p><br></p>
</details>
<details>
<summary>
3. Windows Client Configuration
</summary>
<hr />
<p><strong>Tested on Windows 11.</strong></p>
<p>Create a configuration file named wg0.conf and save it to a convenient location.</p>
<p>The file contents should be as follows. Remember to substitute the correct private key for this client, the server's public key, and the server's public IP address.</p>
<pre><code>[Interface]
PrivateKey = gCJE0PoqARqSnQgq1v87v7QcSzUn97d0abVM7BpqjFc=
Address = 10.100.0.2/32
DNS = 1.1.1.1

[Peer]
PublicKey = OCtqLy2OkpuiBPhmXR0DbhbaVDhpuS4AVDm3yZDP1XU=
Endpoint = 192.227.167.142:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<p>Download and run the Windows installer from <a href="https://www.wireguard.com/install/">Wireguard Install</a>.</p>
<p>After installation, the WireGuard application will run. Click "Add Tunnel" at the bottom left and select "Import tunnel(s) from file." Choose the wg0.conf file you created. To activate the VPN, click the "Activate" button. To deactivate it, click "Deactivate."</p>
<p><br></p>
</details>
<details>
<summary>
4. Android Client Configuration
</summary>
<hr />
<p>Tested on my Samsung devices.</p>
<p>Create a configuration file named wg0.conf and transfer it to your Android device (e.g., via email, cloud storage, or a direct transfer).</p>
<p>The file contents should be as follows. Remember to substitute the correct private key for this client, the server's public key, and the server's public IP address.</p>
<pre><code>[Interface]
PrivateKey = gLoXU+1aNQmcK/OtjSUJGnOXt28w/mRo1szjU+XO/XM=
Address = 10.100.0.3/32
DNS = 1.1.1.1

[Peer]
PublicKey = OCtqLy2OkpuiBPhmXR0DbhbaVDhpuS4AVDm3yZDP1XU=
Endpoint = 192.227.167.142:53
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
</code></pre>
<p>Install the WireGuard app from the Google Play Store: <a href="https://play.google.com/store/apps/details?id=com.wireguard.android&amp;hl=en-US&amp;pli=1">https://play.google.com/store/apps/details?id=com.wireguard.android&amp;hl=en-US&amp;pli=1</a>.</p>
<p>Open the WireGuard app, tap the "+" button, and select "Import from file or archive." Select your wg0.conf file. Once imported, tap the "Activate" switch to start the VPN connection.</p>
<p><br></p>
</details>
<details>
<summary>
5. Other Clients
</summary>
<hr />
<p>The process is similar for other operating systems like macOS and iOS. Download the official WireGuard application, import the configuration file (which has the same structure), and activate the tunnel.</p>
<p><br></p>
</details>
<details>
<summary>
6. Case Study - Configuring for 1,000 Clients
</summary>
<hr />
<p>As a case study, we will configure a server for 1,000 clients. We will use scripts to generate the key pairs, server configuration, and client configurations. You can modify these scripts for different numbers of clients.</p>
<p>Create and enter a temporary working directory:</p>
<pre><code>mkdir /tmp/wg
cd /tmp/wg
</code></pre>
<h3>6.1. Creating Keypairs</h3>
<p>We will create 1,001 key pairs (one for the server and 1,000 for clients). Create the script:</p>
<pre><code>nano keys.sh
</code></pre>
<p>Fill it with the following content. To create 10,000 key pairs, for example, you would change the first for loop to <code>for i in {1..40}</code>.</p>
<pre><code>#!/bin/bash
# Create wireguard public/private key pairs for the server and 1000 client
# Keys will be put on keys directory
# Server keys are named as serverprivkey and serverpubkey
# Client keys are named as 1-1privkey to 1-250privkey, 1-1pubkey to 1-250pubkey
# It goes for 2- 3- 4- and makes total 1,000 keypairs for clients
#
# So if you want to make 10.000 key pairs, change the first for line as:
# for i in {1..40}

mkdir -p keys
wg genkey | tee keys/serverprivkey | wg pubkey &gt; keys/serverpubkey
for i in {1..4} 
do
  for j in {1..250}
  do
    wg genkey | tee keys/&quot;$i&quot;-&quot;$j&quot;privkey | wg pubkey &gt; keys/&quot;$i&quot;-&quot;$j&quot;pubkey
  done
done
</code></pre>
<p>Make the script executable and run it:</p>
<pre><code>chmod +x keys.sh
./keys.sh
</code></pre>
<p>The keys are now in the /tmp/wg/keys directory.</p>
<h3>6.2. Creating Server Configuration</h3>
<p>Create a script to generate the server configuration with 1,000 peers.</p>
<pre><code>nano serverconf.sh
</code></pre>
<p>Fill it with the following content. This script uses the 10.100.0.0/16 network, which supports approximately 65,000 clients.</p>
<pre><code>#!/bin/bash
# Create wireguard server configuration for 1,000 clients.
# Configuration is named as wg0.conf and put in conf directory
# You can directly put the conf file into /etc/wireguard directory
#
# 10.100.0.0/16 network is reserved for clients, that makes a total of 
#   about 65.000 client

mkdir -p confs
echo &gt; confs/wg0.conf

echo '[Interface]' &gt;&gt; confs/wg0.conf
echo Address = 10.100.0.1/16 &gt;&gt; confs/wg0.conf
echo ListenPort = 53 &gt;&gt; confs/wg0.conf
echo PrivateKey = `cat keys/serverprivkey` &gt;&gt; confs/wg0.conf
echo &gt;&gt; confs/wg0.conf
echo &quot;#&quot; NAT for clients &gt;&gt; confs/wg0.conf
echo PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE &gt;&gt; confs/wg0.conf
echo PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE &gt;&gt; confs/wg0.conf

#!/bin/bash
for i in {1..4}
do
  for j in {1..250}
  do 
    echo &gt;&gt; confs/wg0.conf
    echo '[Peer]' &gt;&gt; confs/wg0.conf
    echo &quot;#&quot; Client &quot;$i&quot;-&quot;$j&quot; &gt;&gt; confs/wg0.conf
    echo PublicKey = `cat keys/&quot;$i&quot;-&quot;$j&quot;pubkey` &gt;&gt; confs/wg0.conf
    echo AllowedIPs = 10.100.&quot;$i&quot;.&quot;$j&quot;/32 &gt;&gt; confs/wg0.conf
  done
done
</code></pre>
<p>Make the script executable and run it:</p>
<pre><code>chmod +x serverconf.sh
./serverconf.sh
</code></pre>
<p>The configuration file wg0.conf is now in the /tmp/wg/confs directory and can be copied to /etc/wireguard/ on the server.</p>
<h3>6.3. Creating Client Configurations</h3>
<p>Create a script to generate the 1,000 client configuration files.</p>
<pre><code>nano clientconfs.sh
</code></pre>
<p>Fill it with the following content. Remember to set the serverip variable to your server's public IP address.</p>
<pre><code>#!/bin/bash
# Create 1,000 wireguard client configurations.
# Configurations are put in confs directory and named as wg1-1.conf to 
#    wg1-250.conf.
# It goes for 2- 3- 4- and makes total 1,000 configurations for clients
# You can distribute the configurations to the clients as you wish.
# You have to edit serverip and change it to your wireguard servers.


serverip=192.227.167.142 # REPLACE WITH YOUR SERVER'S PUBLIC IP
for i in {1..4}
do
  for j in {1..250}
  do
    echo '[Interface]' &gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo PrivateKey = `cat keys/&quot;$i&quot;-&quot;$j&quot;privkey` &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo Address = 10.100.&quot;$i&quot;.&quot;$j&quot;/16 &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo DNS = 1.1.1.1 &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo '[Peer]' &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo PublicKey = `cat keys/serverpubkey` &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo Endpoint = &quot;$serverip&quot;:53  &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo AllowedIPs = 0.0.0.0/0, ::/0  &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
    echo PersistentKeepalive = 25  &gt;&gt; confs/wg&quot;$i&quot;-&quot;$j&quot;.conf
  done
done
</code></pre>
<p>Make the script executable and run it:</p>
<pre><code>chmod +x clientconfs.sh
./clientconfs.sh
</code></pre>
<p>The client configuration files are now in the /tmp/wg/confs directory and can be distributed to users.</p>
<h3>6.4. Backup Backup</h3>
<p>Do not forget to back up your key pairs and configuration files securely!</p>
<p><br></p>
</details><!-- HTML Footer Start -->

</body>
</html>

<!-- HTML Footer End -->
